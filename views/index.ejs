<% layout('layout') %>

<section class="hero">
  <div class="hero-content">
    <!-- <span class="badge">مشاوره رایگان</span> -->
    <h1>با ما جوان ترین و زیباترین خود باشید</h1>
    <p>مشاوره اختصاصی و پروتکل درمان مناسب پوست شما</p>

    <div style="display:flex; gap:10px; justify-content:center;">
      <a href="#contact" class="btn">رزرو وقت</a>
      <a href="#services" class="btn outline">مشاهده خدمات</a>
    </div>
  </div>
</section>




<section class="section">
  <h2>خدمات</h2>
  <div class="cards">
    <% services.forEach(s => { %>
      <a href="/services/<%= s.slug %>" class="card" style="display:block; text-decoration:none; color:inherit">
        <h3><%= s.title %></h3>
        <p style="color:var(--muted)"><%= s.text %></p>
      </a>
    <% }) %>
  </div>
</section>



<!-- GALLERY (Tabbed) -->
<section class="section" id="gallery" dir="rtl">
  <header class="card" style="display:grid; gap:10px;">
    <h2 style="margin:0">گالری نمونه‌کار</h2>
    <p style="margin:0; color:var(--muted);">برای هر بخش روی تب کلیک کنید.</p>

    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="Gallery sections" style="display:flex; gap:6px; flex-wrap:wrap;">
      <% sections.forEach((s, i) => { %>
        <button
          class="tab-btn <%= i===0 ? 'active' : '' %>"
          data-target="<%= s.key %>"
          role="tab"
          aria-selected="<%= i===0 ? 'true' : 'false' %>"
          style="border:1px solid var(--border); background:#fff; padding:8px 12px; border-radius:999px; cursor:pointer;">
          <%= s.title %>
        </button>
      <% }) %>
    </div>
  </header>
</section>

<section class="section" dir="rtl">
  <% sections.forEach((s, i) => { %>
    <div class="gallery-grid <%= i===0 ? 'show' : 'hide' %>" id="gal-<%= s.key %>" data-section="<%= s.key %>">
      <div class="cards" style="display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr)); gap:10px;">
        <% (photos[s.key] || []).forEach(src => { %>
          <figure class="card" style="padding:8px; cursor:zoom-in;">
            <img
              src="<%= src %>"
              alt="<%= s.title %>"
              loading="lazy"
              style="width:100%; height:180px; object-fit:cover; border-radius:8px;"
              onclick="openLightbox('<%= src %>')"
            />
          </figure>
        <% }) %>

        <% if (!(photos[s.key] || []).length) { %>
          <div class="card" style="text-align:center; padding:20px;">به زودی تصاویر این بخش اضافه می‌شود.</div>
        <% } %>
      </div>
    </div>
  <% }) %>
</section>

<!-- Lightbox -->
<div id="lightbox" class="hide" aria-hidden="true"
     style="position:fixed; inset:0; background:rgba(0,0,0,.75); display:flex; align-items:center; justify-content:center; z-index:99999; padding:10px;">
  <button onclick="closeLightbox()" aria-label="بستن"
          style="position:absolute; top:14px; left:16px; background:transparent; border:none; color:#fff; font-size:28px; cursor:pointer;">×</button>
  <img id="lightbox-img" src="" alt="preview" style="max-width:96vw; max-height:92vh; border-radius:12px;"/>
</div>

<script>
  // Tabs
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const target = btn.getAttribute('data-target');

      document.querySelectorAll('.tab-btn').forEach(b => {
        b.classList.remove('active');
        b.setAttribute('aria-selected', 'false');
        b.style.background = '#fff';
      });
      btn.classList.add('active');
      btn.setAttribute('aria-selected', 'true');
      btn.style.background = '#F4F7F0';

      document.querySelectorAll('.gallery-grid').forEach(g => {
        if (g.dataset.section === target) {
          g.classList.remove('hide'); g.classList.add('show');
        } else {
          g.classList.remove('show'); g.classList.add('hide');
        }
      });
    });
  });

  // Lightbox
  window.openLightbox = function(src){
    const lb = document.getElementById('lightbox');
    const img = document.getElementById('lightbox-img');
    img.src = src;
    lb.classList.remove('hide');
    lb.setAttribute('aria-hidden', 'false');
  }
  window.closeLightbox = function(){
    const lb = document.getElementById('lightbox');
    const img = document.getElementById('lightbox-img');
    img.src = '';
    lb.classList.add('hide');
    lb.setAttribute('aria-hidden', 'true');
  }
  document.getElementById('lightbox')?.addEventListener('click', (e) => {
    if (e.target.id === 'lightbox') closeLightbox();
  });
</script>

<style>
  .hide{ display:none; }
  .show{ display:block; }
  .tab-btn.active{ background:#F4F7F0 !important; }
</style>


<section id="contact" class="section">
  <h2>تماس با ما</h2>


    <div class="contact-info">
      <h3>اطلاعات تماس</h3>
      <p>ازادشهر چهارراه میلاد ساختمان پزشکان۷۷</p>
      <p>موبایل: 09150739223</p>
      <p>ساعت پاسخگویی: 8:00 تا 21:00</p>
      <div class="map-embed">
  <iframe
    title="Harmony Chehre Clinic Map"
    width="100%"
    height="300"
    style="border:0; border-radius:12px;"
    loading="lazy"
    referrerpolicy="no-referrer-when-downgrade"
    src="https://www.google.com/maps?q=36.3280556,59.5353889&z=16&output=embed">
  </iframe>

  <!-- Optional: quick open-in-app buttons -->
  <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
    <a class="btn outline" href="https://www.google.com/maps?q=36.3280556,59.5353889" target="_blank" rel="noopener">Google Maps</a>
    <a class="btn outline" href="https://waze.com/ul?ll=36.3280556%2C59.5353889&navigate=yes" target="_blank" rel="noopener">Waze</a>
    <!-- iPhone deep link -->
    <a class="btn outline" href="maps://?daddr=36.3280556,59.5353889">Apple Maps</a>
  </div>
</div>

</div>

    </div>
  </div>
</section>

<section id="chat" class="section">
  <h2>چت آنلاین</h2>
  <div class="chatbox">
    <div class="chat-header">
      <span>مشاوره آنلاین</span>
      <small>در ساعات کاری پاسخگو هستیم</small>
    </div>
    <div id="chat-messages" class="chat-messages"></div>
    <form id="chat-form" class="chat-form" autocomplete="off">
      <input id="chat-name" type="text" placeholder="نام شما" maxlength="40" />
      <input id="chat-input" type="text" placeholder="پیام خود را بنویسید..." maxlength="500" />
      <button class="btn" type="submit">ارسال</button>
    </form>
  </div>
</section>

